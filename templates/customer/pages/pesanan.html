<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Pesanan | BCE</title>
        <link
            href="{{url_for('static',filename='dist/output.css')}}"
            rel="stylesheet"
        />
        <!-- Local CSS -->
        <link
            rel="stylesheet"
            href="{{url_for('static',filename='css/customer/style.css')}}"
        />
        <!-- Font Awesome -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
            integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <!-- Tambahan style utilitas -->
        <style>
            .input-field {
                @apply w-full px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-green-600;
            }
            /* Zoom in & out sedang */
            @keyframes zoomPulse {
                0%,
                100% {
                    transform: scale(0.95);
                    opacity: 0.95;
                }
                50% {
                    transform: scale(1.05);
                    opacity: 1;
                }
            }
            .animate-zoom-pulse {
                animation: zoomPulse 2.5s ease-in-out infinite;
            }

            /* Glow neon menyatu logo */
            .logo-glow {
                filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.7))
                    drop-shadow(0 0 20px rgba(255, 255, 255, 0.6))
                    drop-shadow(0 0 40px rgba(144, 238, 144, 0.6));
                animation: glowPulse 1s ease-in-out infinite;
            }

            @keyframes glowPulse {
                0%,
                100% {
                    filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.7))
                        drop-shadow(0 0 16px rgba(255, 255, 255, 0.5))
                        drop-shadow(0 0 32px rgba(144, 238, 144, 0.5));
                }
                50% {
                    filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.9))
                        drop-shadow(0 0 30px rgba(255, 255, 255, 0.8))
                        drop-shadow(0 0 60px rgba(144, 238, 144, 0.7));
                }
            }

            .stepper-line {
                flex: 1;
                height: 4px;
                background-color: #e5e7eb; /* default abu-abu */
                transition: background-color 0.3s ease-in-out;
            }
            .stepper-line.active {
                background-color: #16a34a; /* hijau */
            }
            .step-btn {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 3rem;
                height: 3rem;
                border-radius: 9999px;
                background-color: #f3f4f6; /* abu default */
                transition: all 0.3s ease-in-out;
            }
            .step-btn.active {
                background-color: #bbf7d0; /* hijau muda */
            }
        </style>
        <!-- Google icon -->
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        />
    </head>
    <body class="font-sans">
        <!-- Navbar -->
        {% include 'customer/components/navbar.html' %}

        <!-- floating -->
        {% include 'customer/components/floating-sidebar.html' %}

        <section class="bg-zinc-100 py-12">
            <div class="max-w-5xl mx-auto px-6">
                <div class="bg-white p-8 rounded-lg shadow-lg">
                    <h2
                        class="text-3xl font-bold text-green-800 mb-6 text-center"
                    >
                        Buat Pesanan
                    </h2>
                    <!-- Stepper -->
                    <div class="flex items-center w-full mb-8">
                        <!-- Step 1 -->
                        <div class="flex items-center">
                            <button id="step-0" class="step-btn active">
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >local_shipping</span
                                >
                            </button>
                        </div>
                        <div id="line-0" class="stepper-line"></div>

                        <!-- Step 2 -->
                        <div class="flex items-center">
                            <button id="step-1" class="step-btn">
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >move_to_inbox</span
                                >
                            </button>
                        </div>
                        <div id="line-1" class="stepper-line"></div>

                        <!-- Step 3 -->
                        <div class="flex items-center">
                            <button id="step-2" class="step-btn">
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >inventory_2</span
                                >
                            </button>
                        </div>
                    </div>

                    <!-- ALERT -->
                    <div
                        class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6 animate-pulse"
                        role="alert"
                    >
                        <p class="font-bold">Perhatian</p>
                        <p>Pastikan informasi yang Anda isi sudah benar.</p>
                    </div>

                    <!-- FORM -->
                    <form
                        action="#"
                        method="POST"
                        class="space-y-10"
                        id="form-pemesanan"
                    >
                        <!-- INFORMASI PENGIRIM -->
                        <div
                            id="info_pengirim"
                            role="tabpanel"
                            class="space-y-6"
                        >
                            <h3
                                class="text-2xl font-bold text-green-800 mb-4 flex items-center gap-2"
                            >
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >local_shipping</span
                                >
                                Informasi Pengirim
                            </h3>

                            <!-- Nama -->
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >person</span
                                >
                                <input
                                    type="text"
                                    id="nama_pengirim"
                                    name="nama_pengirim"
                                    maxlength="100"
                                    required
                                    placeholder="Nama Lengkap"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>

                            <!-- WhatsApp + Kode Pos -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >chat</span
                                    >
                                    <input
                                        type="tel"
                                        id="whatsapp_pengirim"
                                        name="whatsapp_pengirim"
                                        minlength="10"
                                        maxlength="13"
                                        required
                                        placeholder="Nomor WhatsApp"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >markunread_mailbox</span
                                    >
                                    <input
                                        type="text"
                                        id="kodepos_pengirim"
                                        name="kodepos_pengirim"
                                        minlength="5"
                                        maxlength="5"
                                        required
                                        placeholder="Kode Pos"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                            </div>

                            <!-- Jalan -->
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >map</span
                                >
                                <input
                                    type="text"
                                    id="jalan_pengirim"
                                    name="jalan_pengirim"
                                    maxlength="100"
                                    required
                                    placeholder="Jalan"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>

                            <!-- RT + RW -->
                            <div class="grid grid-cols-2 gap-6">
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >pin</span
                                    >
                                    <input
                                        type="text"
                                        id="rt_pengirim"
                                        name="rt_pengirim"
                                        minlength="4"
                                        maxlength="4"
                                        required
                                        placeholder="RT"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >pin_drop</span
                                    >
                                    <input
                                        type="text"
                                        id="rw_pengirim"
                                        name="rw_pengirim"
                                        minlength="4"
                                        maxlength="4"
                                        required
                                        placeholder="RW"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                            </div>

                            <!-- Provinsi, Kabupaten, Kecamatan, Kelurahan -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <select
                                    id="provinsi_pengirim"
                                    name="provinsi_pengirim"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Provinsi</option>
                                </select>
                                <select
                                    id="kabupaten_pengirim"
                                    name="kabupaten_pengirim"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kabupaten</option>
                                </select>
                                <select
                                    id="kecamatan_pengirim"
                                    name="kecamatan_pengirim"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kecamatan</option>
                                </select>
                                <select
                                    id="kelurahan_pengirim"
                                    name="kelurahan_pengirim"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kelurahan</option>
                                </select>
                            </div>

                            <!-- Tombol Selanjutnya -->
                            <div class="flex justify-end pt-6">
                                <button
                                    type="submit"
                                    class="rounded-lg bg-green-600 px-6 py-2 text-sm font-medium text-white hover:bg-green-700 shadow cursor-pointer"
                                >
                                    Selanjutnya
                                </button>
                            </div>
                        </div>

                        <!-- INFORMASI PENERIMA -->
                        <div
                            id="info_penerima"
                            role="tabpanel"
                            class="space-y-6"
                        >
                            <h3
                                class="text-2xl font-bold text-green-800 mb-4 flex items-center gap-2"
                            >
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >move_to_inbox</span
                                >
                                Informasi Penerima
                            </h3>
                            <!-- Nama -->
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >person</span
                                >
                                <input
                                    type="text"
                                    id="nama_penerima"
                                    name="nama_penerima"
                                    maxlength="100"
                                    required
                                    placeholder="Nama Lengkap"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>

                            <!-- WhatsApp + Kode Pos -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >chat</span
                                    >
                                    <input
                                        type="tel"
                                        id="whatsapp_penerima"
                                        name="whatsapp_penerima"
                                        minlength="10"
                                        maxlength="13"
                                        required
                                        placeholder="Nomor WhatsApp"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >markunread_mailbox</span
                                    >
                                    <input
                                        type="text"
                                        id="kodepos_penerima"
                                        name="kodepos_penerima"
                                        minlength="5"
                                        maxlength="5"
                                        required
                                        placeholder="Kode Pos"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                            </div>

                            <!-- Jalan -->
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >map</span
                                >
                                <input
                                    type="text"
                                    id="jalan_penerima"
                                    name="jalan_penerima"
                                    maxlength="100"
                                    required
                                    placeholder="Jalan"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>

                            <!-- RT + RW -->
                            <div class="grid grid-cols-2 gap-6">
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >pin</span
                                    >
                                    <input
                                        type="text"
                                        id="rt_penerima"
                                        name="rt_penerima"
                                        minlength="4"
                                        maxlength="4"
                                        required
                                        placeholder="RT"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >pin_drop</span
                                    >
                                    <input
                                        type="text"
                                        id="rw_penerima"
                                        name="rw_penerima"
                                        minlength="4"
                                        maxlength="4"
                                        required
                                        placeholder="RW"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                            </div>

                            <!-- Provinsi, Kabupaten, Kecamatan, Kelurahan -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <select
                                    id="provinsi_penerima"
                                    name="provinsi_penerima"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Provinsi</option>
                                </select>
                                <select
                                    id="kabupaten_penerima"
                                    name="kabupaten_penerima"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kabupaten</option>
                                </select>
                                <select
                                    id="kecamatan_penerima"
                                    name="kecamatan_penerima"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kecamatan</option>
                                </select>
                                <select
                                    id="kelurahan_penerima"
                                    name="kelurahan_penerima"
                                    required
                                    class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                >
                                    <option value="">Pilih Kelurahan</option>
                                </select>
                            </div>

                            <!-- Tombol Navigasi -->
                            <div class="flex justify-end gap-3 pt-6">
                                <button
                                    type="button"
                                    class="rounded-lg bg-gray-400 px-6 py-2 text-sm font-medium text-white hover:bg-gray-500 shadow cursor-pointer"
                                >
                                    Sebelumnya
                                </button>
                                <button
                                    type="submit"
                                    class="rounded-lg bg-green-600 px-6 py-2 text-sm font-medium text-white hover:bg-green-700 shadow cursor-pointer"
                                >
                                    Selanjutnya
                                </button>
                            </div>
                        </div>

                        <!-- INFORMASI BARANG -->
                        <div id="info-barang" role="tabpanel" class="space-y-6">
                            <h3
                                class="text-2xl font-bold text-green-800 mb-4 flex items-center gap-2"
                            >
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >inventory_2</span
                                >
                                Informasi Barang
                            </h3>
                            <div
                                id="form-barang-container"
                                class="flex flex-col gap-5"
                            >
                                <div class="space-y-6 form-barang">
                                    <!-- Nama Barang -->
                                    <div class="relative">
                                        <span
                                            class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                            >shopping_bag</span
                                        >
                                        <input
                                            type="text"
                                            id="nama-barang"
                                            name="nama-barang[]"
                                            maxlength="100"
                                            required
                                            placeholder="Nama Barang"
                                            class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                        />
                                    </div>

                                    <!-- Jumlah & Berat -->
                                    <div
                                        class="grid grid-cols-1 md:grid-cols-2 gap-6"
                                    >
                                        <div class="relative">
                                            <span
                                                class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                                >format_list_numbered</span
                                            >
                                            <input
                                                type="number"
                                                id="jumlah-barang"
                                                name="jumlah-barang[]"
                                                min="1"
                                                required
                                                placeholder="Jumlah"
                                                class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                            />
                                        </div>
                                        <div class="relative">
                                            <span
                                                class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                                >fitness_center</span
                                            >
                                            <input
                                                type="number"
                                                id="berat-barang"
                                                name="berat-barang[]"
                                                min="0.1"
                                                step="0.1"
                                                required
                                                placeholder="Berat (Kg)"
                                                class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                            />
                                        </div>
                                    </div>

                                    <!-- Dimensi -->
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 mb-2"
                                            >Dimensi (cm)</label
                                        >
                                        <div
                                            class="grid grid-cols-1 md:grid-cols-3 gap-6"
                                        >
                                            <div class="relative">
                                                <span
                                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                                    >straighten</span
                                                >
                                                <input
                                                    type="number"
                                                    id="panjang"
                                                    name="panjang[]"
                                                    min="0"
                                                    required
                                                    placeholder="Panjang"
                                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                                />
                                            </div>
                                            <div class="relative">
                                                <span
                                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                                    >straighten</span
                                                >
                                                <input
                                                    type="number"
                                                    id="lebar"
                                                    name="lebar[]"
                                                    min="0"
                                                    required
                                                    placeholder="Lebar"
                                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                                />
                                            </div>
                                            <div class="relative">
                                                <span
                                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                                    >straighten</span
                                                >
                                                <input
                                                    type="number"
                                                    id="tinggi"
                                                    name="tinggi[]"
                                                    min="0"
                                                    required
                                                    placeholder="Tinggi"
                                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Kategori -->
                                    <div class="relative">
                                        <select
                                            id="kategori-barang"
                                            name="kategori-barang[]"
                                            required
                                            class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                        >
                                            <option value="" selected>
                                                Pilih Kategori
                                            </option>
                                        </select>
                                    </div>

                                    <!-- Asuransi -->
                                    <div>
                                        <p
                                            class="text-sm font-medium text-gray-700 mb-2"
                                        >
                                            Butuh Asuransi?
                                        </p>
                                        <div class="flex items-center gap-6">
                                            <label
                                                class="flex items-center gap-2 text-sm text-gray-700"
                                            >
                                                <input
                                                    type="radio"
                                                    name="asuransi_0"
                                                    value="true"
                                                    required
                                                    class="text-green-600 focus:ring-green-500"
                                                />
                                                Ya
                                            </label>
                                            <label
                                                class="flex items-center gap-2 text-sm text-gray-700"
                                            >
                                                <input
                                                    type="radio"
                                                    name="asuransi_0"
                                                    value="false"
                                                    required
                                                    class="text-green-600 focus:ring-green-500"
                                                />
                                                Tidak
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Metode Pengiriman -->
                                    <div class="relative">
                                        <select
                                            id="metode-pengiriman"
                                            name="metode-pengiriman[]"
                                            required
                                            class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                                        >
                                            <option value="" selected>
                                                Pilih Metode Pengiriman
                                            </option>
                                            <option value="Darat">Darat</option>
                                            <option value="Laut">Laut</option>
                                            <option value="Udara">Udara</option>
                                        </select>
                                    </div>

                                    <!-- Catatan Tambahan -->
                                    <div class="relative">
                                        <textarea
                                            id="catatan-barang"
                                            name="catatan-barang[]"
                                            rows="3"
                                            placeholder="Catatan tambahan..."
                                            class="block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500"
                                        ></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Tambah barang -->
                            <button
                                type="button"
                                id="btn-tambah-barang"
                                class="flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm pl-3 pr-6 py-2 m-0 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800"
                            >
                                <svg
                                    class="w-6 h-6 text-white"
                                    aria-hidden="true"
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="24"
                                    height="24"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                >
                                    <path
                                        stroke="currentColor"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M5 12h14m-7 7V5"
                                    />
                                </svg>

                                <span>Tambah</span>
                            </button>

                            <!-- Tombol Navigasi -->
                            <div class="flex justify-end gap-3 pt-6">
                                <button
                                    type="button"
                                    class="rounded-lg bg-gray-400 px-6 py-2 text-sm font-medium text-white hover:bg-gray-500 shadow cursor-pointer"
                                >
                                    Sebelumnya
                                </button>
                                <button
                                    type="submit"
                                    class="rounded-lg bg-green-600 px-6 py-2 text-sm font-medium text-white hover:bg-green-700 shadow cursor-pointer relative overflow-hidden"
                                    onclick="buatPesanan(event, this)"
                                >
                                    <span class="button-text">Pesan</span>

                                    <!-- Overlay untuk spinner -->
                                    <span
                                        class="loading-overlay absolute inset-0 flex items-center justify-center bg-green-600/70 pointer-events-none hidden"
                                    >
                                        <svg
                                            aria-hidden="true"
                                            role="status"
                                            class="inline w-5 h-5 text-white animate-spin"
                                            viewBox="0 0 100 101"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg"
                                        >
                                            <path
                                                d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 
                                        100.591 0 78.2051 0 50.5908C0 22.9766 
                                        22.3858 0.59082 50 0.59082C77.6142 
                                        0.59082 100 22.9766 100 50.5908ZM9.08144 
                                        50.5908C9.08144 73.1895 27.4013 91.5094 
                                        50 91.5094C72.5987 91.5094 90.9186 
                                        73.1895 90.9186 50.5908C90.9186 27.9921 
                                        72.5987 9.67226 50 9.67226C27.4013 
                                        9.67226 9.08144 27.9921 9.08144 
                                        50.5908Z"
                                                fill="#E5E7EB"
                                            />
                                            <path
                                                d="M93.9676 39.0409C96.393 38.4038 
                                        97.8624 35.9116 97.0079 33.5539C95.2932 
                                        28.8227 92.871 24.3692 89.8167 
                                        20.348C85.8452 15.1192 80.8826 
                                        10.7238 75.2124 7.41289C69.5422 
                                        4.10194 63.2754 1.94025 56.7698 
                                        1.05124C51.7666 0.367541 46.6976 
                                        0.446843 41.7345 1.27873C39.2613 
                                        1.69328 37.813 4.19778 38.4501 
                                        6.62326C39.0873 9.04874 41.5694 
                                        10.4717 44.0505 10.1071C47.8511 
                                        9.54855 51.7191 9.52689 55.5402 
                                        10.0491C60.8642 10.7766 65.9928 
                                        12.5457 70.6331 15.2552C75.2735 
                                        17.9648 79.3347 21.5619 82.5849 
                                        25.841C84.9175 28.9121 86.7997 
                                        32.2913 88.1811 35.8758C89.083 
                                        38.2158 91.5421 39.6781 93.9676 
                                        39.0409Z"
                                                fill="currentColor"
                                            />
                                        </svg>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>
        <!-- Overlay Transition -->
        <div
            id="page-transition"
            class="fixed inset-0 z-[9999] flex items-center justify-center bg-green-600 transform translate-x-full transition-transform duration-700 ease-in-out"
        >
            <!-- Logo BCE -->
            <div class="relative flex items-center justify-center">
                <!-- Logo + efek glow -->
                <img
                    src="/static/images/logo_transparant.png"
                    alt="BCE Logo"
                    class="relative w-24 h-24 animate-zoom-pulse logo-glow"
                    id="bce-logo"
                />
            </div>
        </div>

        <!-- footer -->
        {% include 'customer/components/footer.html' %}
        <!-- Flowbite JS -->
        <script src="/node_modules/flowbite/dist/flowbite.min.js"></script>
        <script src="{{url_for('static',filename='js/customer/fetch-wilayah.js')}}"></script>
        <script>
            const transitionEl = document.getElementById("page-transition");
            const links = document.querySelectorAll(".page-link");
            let formPemesanan = document.getElementById("form-pemesanan");

            links.forEach((link) => {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    const target = this.getAttribute("href");

                    // Tirai menutup
                    transitionEl.classList.remove("translate-x-full");
                    transitionEl.classList.add("translate-x-0");

                    // Redirect setelah animasi selesai
                    setTimeout(() => {
                        window.location.href = target;
                    }, 1200);
                });
            });

            // Tirai terbuka saat pertama load halaman
            window.addEventListener("load", () => {
                setTimeout(() => {
                    transitionEl.classList.add("translate-x-full");
                    transitionEl.classList.remove("translate-x-0");
                }, 500);
            });

            document.addEventListener("DOMContentLoaded", function () {
                const steps = ["info_pengirim", "info_penerima", "info-barang"];
                let currentStep = 0;

                function updateStepper() {
                    steps.forEach((_, index) => {
                        const btn = document.getElementById(`step-${index}`);
                        const line = document.getElementById(`line-${index}`);
                        if (btn) {
                            btn.classList.toggle(
                                "active",
                                index <= currentStep
                            );
                        }
                        if (line) {
                            line.classList.toggle(
                                "active",
                                index < currentStep
                            );
                        }
                    });
                }

                function showStep(step) {
                    steps.forEach((id, index) => {
                        const panel = document.getElementById(id);
                        if (panel) {
                            panel.style.display =
                                index === step ? "block" : "none";
                        }
                    });
                    currentStep = step;
                    updateStepper();
                }

                // tombol navigasi
                const form = document.getElementById("form-pemesanan");
                form.addEventListener("click", function (e) {
                    if (e.target.tagName === "BUTTON") {
                        if (e.target.textContent.includes("Selanjutnya")) {
                            e.preventDefault();
                            if (currentStep < steps.length - 1) {
                                showStep(currentStep + 1);
                            }
                        }
                        if (e.target.textContent.includes("Sebelumnya")) {
                            e.preventDefault();
                            if (currentStep > 0) {
                                showStep(currentStep - 1);
                            }
                        }
                    }
                });

                // init pertama
                showStep(currentStep);
            });

            // Muat kategori barang
            function muatKatgoriBarang(elmSelect) {
                fetch("/customer/api/data/kategori_barang", {
                    method: "GET",
                })
                    .then(async (respon) => {
                        const data = await respon.json();
                        if (!respon.ok) {
                            throw new Error(data.message);
                        }
                        return data;
                    })
                    .then((data) => {
                        const kategoriBarang = data.data;
                        kategoriBarang.forEach((item) => {
                            const opsi = new Option(
                                item.nama_kategori,
                                item._id
                            );
                            elmSelect.add(opsi);
                        });
                    })
                    .catch((error) => {
                        console.error(error);
                    });
            }

            // Muat biodata dari database
            function muatDataPelanggan() {
                fetch("/customer/api/data/pelanggan", {
                    method: "GET",
                })
                    .then(async (respon) => {
                        const data = await respon.json();
                        if (!respon.ok) {
                            console.error(data.message);

                            throw new Error(data.data);
                        }
                        return data;
                    })
                    .then((data) => {
                        const biodata = data.data;

                        // Biodata
                        formPemesanan.nama_pengirim.value =
                            biodata.nama_lengkap;
                        formPemesanan.whatsapp_pengirim.value =
                            biodata.no_telepon;

                        // Alamat
                        formPemesanan.jalan_pengirim.value =
                            biodata.alamat.jalan;
                        formPemesanan.kodepos_pengirim.value =
                            biodata.alamat.kode_pos;
                        formPemesanan.rt_pengirim.value = biodata.alamat.rt;
                        formPemesanan.rw_pengirim.value = biodata.alamat.rw;

                        // Wilayah
                        initWilayah({
                            selectProvinsi: formPemesanan.provinsi_pengirim,
                            selectKabupaten: formPemesanan.kabupaten_pengirim,
                            selectKecamatan: formPemesanan.kecamatan_pengirim,
                            selectKelurahan: formPemesanan.kelurahan_pengirim,
                            dataWilayah: biodata.alamat, // objek hasil dari database
                        });
                    })
                    .catch((error) => {
                        console.error(error);
                    });
            }
            muatDataPelanggan();

            // Muat wilayah indonesia untuk penerima
            initWilayah({
                selectProvinsi: formPemesanan.provinsi_penerima,
                selectKabupaten: formPemesanan.kabupaten_penerima,
                selectKecamatan: formPemesanan.kecamatan_penerima,
                selectKelurahan: formPemesanan.kelurahan_penerima,
            });

            // Tambah barang
            let jumlahbarang = 1;
            const barangContainer = document.getElementById(
                "form-barang-container"
            );

            muatKatgoriBarang(document.getElementById("kategori-barang"));

            function tambahBarang() {
                barangContainer.innerHTML += `
                    <div class="space-y-6 form-barang">
                        <div class="flex items-center justify-between">
                            <h3
                                class="text-2xl font-bold text-green-800 mb-4 flex items-center gap-2"
                            >
                                <span
                                    class="material-symbols-rounded text-green-600"
                                    >inventory_2</span
                                >
                                Informasi Barang
                            </h3>

                            <button
                                type="button"
                                class="hapus-barang flex items-center gap-2 focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm m-0 pl-3 pr-6 py-2 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900"
                            >
                                <svg
                                    class="w-6 h-6:text-white"
                                    aria-hidden="true"
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="24"
                                    height="24"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    <path
                                        fill-rule="evenodd"
                                        d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z"
                                        clip-rule="evenodd"
                                    />
                                </svg>
                            
                                <span>Hapus</span>
                            </button>
                        </div>
                        <!-- Nama Barang -->
                        <div class="relative">
                            <span
                                class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                >shopping_bag</span
                            >
                            <input
                                type="text"
                                id="nama-barang-${jumlahbarang}"
                                name="nama-barang[]"
                                maxlength="100"
                                required
                                placeholder="Nama Barang"
                                class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                            />
                        </div>
                    
                        <!-- Jumlah & Berat -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >format_list_numbered</span
                                >
                                <input
                                    type="number"
                                    id="jumlah-barang-${jumlahbarang}"
                                    name="jumlah-barang[]"
                                    min="1"
                                    required
                                    placeholder="Jumlah"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>
                            <div class="relative">
                                <span
                                    class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                    >fitness_center</span
                                >
                                <input
                                    type="number"
                                    id="berat-barang-${jumlahbarang}"
                                    name="berat-barang[]"
                                    min="0.1"
                                    step="0.1"
                                    required
                                    placeholder="Berat (Kg)"
                                    class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                />
                            </div>
                        </div>
                    
                        <!-- Dimensi -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2"
                                >Dimensi (cm)</label
                            >
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >straighten</span
                                    >
                                    <input
                                        type="number"
                                        id="panjang-${jumlahbarang}"
                                        name="panjang[]"
                                        min="0"
                                        required
                                        placeholder="Panjang"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >straighten</span
                                    >
                                    <input
                                        type="number"
                                        id="lebar-${jumlahbarang}"
                                        name="lebar[]"
                                        min="0"
                                        required
                                        placeholder="Lebar"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                                <div class="relative">
                                    <span
                                        class="material-symbols-rounded absolute left-3 top-2.5 text-gray-400"
                                        >straighten</span
                                    >
                                    <input
                                        type="number"
                                        id="tinggi-${jumlahbarang}"
                                        name="tinggi[]"
                                        min="0"
                                        required
                                        placeholder="Tinggi"
                                        class="block w-full rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500 invalid:border-red-500 transition"
                                    />
                                </div>
                            </div>
                        </div>
                    
                        <!-- Kategori -->
                        <div class="relative">
                            <select
                                id="kategori-barang-${jumlahbarang}"
                                name="kategori-barang[]"
                                required
                                class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                            >
                                <option value="" selected>Pilih Kategori</option>
                            </select>
                        </div>
                    
                        <!-- Asuransi -->
                        <div>
                            <p class="text-sm font-medium text-gray-700 mb-2">Butuh Asuransi?</p>
                            <div class="flex items-center gap-6">
                                <label class="flex items-center gap-2 text-sm text-gray-700">
                                    <input
                                        type="radio"
                                        name="asuransi_${jumlahbarang}"
                                        value="true"
                                        required
                                        class="text-green-600 focus:ring-green-500"
                                    />
                                    Ya
                                </label>
                                <label class="flex items-center gap-2 text-sm text-gray-700">
                                    <input
                                        type="radio"
                                        name="asuransi_${jumlahbarang}"
                                        value="false"
                                        required
                                        class="text-green-600 focus:ring-green-500"
                                    />
                                    Tidak
                                </label>
                            </div>
                        </div>
                    
                        <!-- Metode Pengiriman -->
                        <div class="relative">
                            <select
                                id="metode-pengiriman-${jumlahbarang}"
                                name="metode-pengiriman[]"
                                required
                                class="block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 focus:border-green-500 focus:ring-green-500"
                            >
                                <option value="" selected>Pilih Metode Pengiriman</option>
                                <option value="Darat">Darat</option>
                                <option value="Laut">Laut</option>
                                <option value="Udara">Udara</option>
                            </select>
                        </div>
                    
                        <!-- Catatan Tambahan -->
                        <div class="relative">
                            <textarea
                                id="catatan-barang-${jumlahbarang}"
                                name="catatan-barang[]"
                                rows="3"
                                placeholder="Catatan tambahan..."
                                class="block w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-700 bg-white focus:border-green-500 focus:ring-green-500"
                            ></textarea>
                        </div>
                    </div>

                `;
                muatKatgoriBarang(
                    document.getElementById(`kategori-barang-${jumlahbarang}`)
                );
                jumlahbarang++;
            }

            document
                .getElementById("btn-tambah-barang")
                .addEventListener("click", () => {
                    tambahBarang();
                });

            barangContainer.addEventListener("click", (e) => {
                if (e.target.closest(".hapus-barang")) {
                    e.target.closest(".form-barang").remove();
                }
            });

            // Buat pesanan
            function buatPesanan(event, btn) {
                event.preventDefault();

                // Tampilkan overlay spinner
                btn.querySelector(".loading-overlay").classList.remove(
                    "hidden"
                );
                btn.classList.add("pointer-events-none"); // blokir klik

                formPemesanan = document.getElementById("form-pemesanan");
                const dataPemesanan = new FormData(formPemesanan);
                let formBarang = document.querySelectorAll(".form-barang");
                let dataBarang = [];

                formBarang.forEach((element, i) => {
                    const nama_barang = element.querySelector(
                        "[name='nama-barang[]']"
                    ).value;
                    const jumlah_barang = element.querySelector(
                        "[name='jumlah-barang[]']"
                    ).value;
                    const berat_barang = element.querySelector(
                        "[name='berat-barang[]']"
                    ).value;
                    const panjang =
                        element.querySelector("[name='panjang[]']").value;
                    const lebar =
                        element.querySelector("[name='lebar[]']").value;
                    const tinggi =
                        element.querySelector("[name='tinggi[]']").value;
                    const kategori_barang = element.querySelector(
                        "[name='kategori-barang[]']"
                    ).value;

                    // Asuransi
                    const asuransi = element.querySelector(
                        `input[name='asuransi_${i}']:checked`
                    );
                    const butuh_asuransi = asuransi ? asuransi.value : "";

                    const metode_pengiriman = element.querySelector(
                        "[name='metode-pengiriman[]']"
                    ).value;
                    const catatan_barang = element.querySelector(
                        "[name='catatan-barang[]']"
                    ).value;

                    // Push ke dataBarang[]
                    dataBarang.push({
                        nama_barang,
                        jumlah_barang,
                        berat_barang,
                        panjang,
                        lebar,
                        tinggi,
                        kategori_barang,
                        butuh_asuransi,
                        metode_pengiriman,
                        catatan_barang,
                    });
                });

                dataPemesanan.append("data_barang", JSON.stringify(dataBarang));

                // for (const [name, value] of dataPemesanan) {
                //     console.log(`${name}: ${value}`);
                // }

                // Kirim
                fetch("/customer/api/pemesanan", {
                    method: "POST",
                    body: dataPemesanan,
                })
                    .then(async (respon) => {
                        const data = await respon.json();
                        if (!respon.ok) {
                            throw new Error(data.message);
                        }
                        return data;
                    })
                    .then((data) => {
                        alert(data.message);

                        // Hilangkan overlay spinner
                        btn.querySelector(".loading-overlay").classList.add(
                            "hidden"
                        );
                        btn.classList.remove("pointer-events-none"); // blokir klik

                        // Pindahkan user ke halaman riwayat pesanan
                        location.href = "/customer/riwayat";
                    })
                    .catch((error) => {
                        console.error(error);
                    });
            }
        </script>
    </body>
</html>
